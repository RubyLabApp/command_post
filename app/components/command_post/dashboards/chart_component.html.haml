%div{ class: "#{theme.card_bg} border #{theme.card_border} #{theme.border_radius} #{theme.card_shadow} p-6" }
  %h3.text-lg.font-semibold.mb-4{ class: theme.body_text }
    = title
  %div{ style: "height: #{height}px; position: relative;" }
    %canvas{ id: chart_id }
  :javascript
    (function() {
      function initChart() {
        var ctx = document.getElementById("#{chart_id}");
        if (!ctx) return;
        new Chart(ctx, #{chart_config});
      }
      if (typeof Chart !== "undefined") {
        initChart();
      } else {
        var script = document.querySelector("script[src*='chart.js']") || document.querySelector("script[src*='chart.umd']");
        if (!script) {
          script = document.createElement("script");
          script.src = "https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js";
          script.onload = initChart;
          document.head.appendChild(script);
        } else {
          script.addEventListener("load", initChart);
        }
      }
    })();
