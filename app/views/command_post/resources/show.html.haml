.p-8.max-w-7xl.mx-auto{ class: t.font_family }
  .flex.items-center.justify-between.mb-6
    %h1.text-2xl{ class: cp_heading }
      = @resource_class.model.model_name.human
      %span.text-gray-400= "##{@record.id}"
    .flex.gap-2
      - if @resource_class.action_allowed?(:update)
        = link_to "Edit", edit_resource_path(@resource_class.resource_name, @record),
          class: cp_btn_primary
      - if @resource_class.action_allowed?(:destroy)
        = button_to "Delete", resource_path(@resource_class.resource_name, @record),
          method: :delete, data: { turbo_confirm: "Are you sure?" },
          class: cp_btn_danger

  .overflow-hidden{ class: cp_card }
    %dl{ class: "#{cp_table_border} divide-y" }
      - @fields.each do |field|
        - next unless field.visible?(command_post_current_user)
        .px-6.py-4.flex.items-center
          %dt.text-sm.font-medium{ class: "w-1/3 #{cp_muted_text}" }= field.name.to_s.humanize
          %dd.text-sm{ class: "w-2/3 #{cp_body_text}" }= display_field_value(@record, field)

  - @resource_class.has_many_associations.each do |assoc|
    - related_records = @record.public_send(assoc[:name]).limit(20)
    - next if related_records.empty?
    .mt-6.overflow-hidden{ class: cp_card }
      .px-6.py-4.border-b.flex.items-center.justify-between{ class: t.card_border }
        %h2.text-lg.font-semibold= assoc[:name].to_s.humanize
        = link_to "View all",
          resources_path(assoc[:resource].resource_name),
          class: "text-sm #{cp_link}"
      %table.min-w-full{ class: "#{cp_table_border} divide-y" }
        %tbody{ class: "#{cp_table_border} divide-y" }
          - related_records.each do |related|
            %tr{ class: cp_table_row_hover }
              %td.px-6.py-3.text-sm{ class: cp_body_text }
                - display = assoc[:display]
                = link_to display_record_label(related, display),
                  resource_path(assoc[:resource].resource_name, related),
                  class: cp_link

  - if @resource_class.defined_actions.any?
    .mt-6.p-6{ class: cp_card }
      %h2.text-lg.font-semibold.mb-4 Actions
      .flex.gap-2
        - @resource_class.defined_actions.each do |action|
          = button_to resource_action_path(@resource_class.resource_name, @record, action[:name]),
            data: action[:confirm] ? { turbo_confirm: "Are you sure?" } : {},
            class: cp_btn_ghost do
            - if action[:icon]
              = heroicon action[:icon], variant: :outline, options: { class: "h-5 w-5" }
            = action[:name].to_s.humanize
